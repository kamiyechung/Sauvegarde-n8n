{
  "active": false,
  "connections": {
    "Start": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "Function",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Function": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "HTTP Request1",
            "type": "main",
            "index": 0
          },
          {
            "node": "HTTP Request2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request1": {
      "main": [
        [
          {
            "node": "Function1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request2": {
      "main": [
        [
          {
            "node": "Function2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Function1": {
      "main": [
        [
          {
            "node": "Set1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Function2": {
      "main": [
        [
          {
            "node": "Set2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-10-24T13:50:42.470Z",
  "id": "eoVJcPkrA6ozcqUk",
  "isArchived": true,
  "meta": null,
  "name": "WPML Translation Links Fixer - Camille-patisserie",
  "nodes": [
    {
      "parameters": {},
      "name": "Start",
      "type": "n8n-nodes-base.start",
      "position": [
        -800,
        208
      ],
      "id": "407477d1-1e77-411e-9ad2-21228a5f2d10",
      "typeVersion": 1
    },
    {
      "parameters": {
        "url": "https://camille-patisserie.fr",
        "options": {}
      },
      "name": "HTTP Request",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        -608,
        208
      ],
      "id": "af6f6665-9db7-42e9-ae1c-0d1204b93a42",
      "typeVersion": 4.2
    },
    {
      "parameters": {
        "functionCode": "// Parsing the HTML to extract all internal links\nconst cheerio = require('cheerio');\nconst $ = cheerio.load(items[0].data);\n\nlet links = [];\n$('a').each((i, link) => {\n  href = $(link).attr('href');\n  if (href.startsWith('/')) {\n    links.push(href);\n  }\n});\n\nreturn links;"
      },
      "name": "Function",
      "type": "n8n-nodes-base.function",
      "position": [
        -400,
        208
      ],
      "id": "e92e0c7f-0e63-4187-aa4a-d00e942a0f55",
      "typeVersion": 1
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict"
                },
                "conditions": [
                  {
                    "leftValue": "",
                    "rightValue": "",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "name": "Switch",
      "type": "n8n-nodes-base.switch",
      "position": [
        -208,
        208
      ],
      "id": "e8baaf94-2657-432f-8159-fe078d932323",
      "typeVersion": 3.3
    },
    {
      "parameters": {
        "url": "=https://camille-patisserie.fr/fr{{ $json }}",
        "options": {}
      },
      "name": "HTTP Request1",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        0,
        0
      ],
      "id": "79f06a06-1916-4e30-ba29-f3510b815c35",
      "typeVersion": 4.2
    },
    {
      "parameters": {
        "url": "=https://camille-patisserie.fr/en{{ $json }}",
        "options": {}
      },
      "name": "HTTP Request2",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        0,
        400
      ],
      "id": "07697a81-085c-4ad2-b278-ce92bd11086f",
      "typeVersion": 4.2
    },
    {
      "parameters": {
        "functionCode": "// Check if French URL returns 200 OK\nif (items[0].data.startsWith('200')) {\n  return;\n}\n// French URL is broken, fetch the correct one  \nconst cheerio = require('cheerio');\nconst $ = cheerio.load(items[1].data);\nconst frenchURL = $('link[hreflang=\"fr\"]').attr('href');\n\nreturn { \n  oldURL: items[0].json,\n  newURL: frenchURL\n};"
      },
      "name": "Function1",
      "type": "n8n-nodes-base.function",
      "position": [
        208,
        0
      ],
      "id": "bb90befc-dada-44d0-a516-fdacd7b8c8bb",
      "typeVersion": 1
    },
    {
      "parameters": {
        "functionCode": "// Check if English URL returns 200 OK \nif (items[0].data.startsWith('200')) {\n  return;\n}\n// English URL is broken, fetch the correct one\nconst cheerio = require('cheerio');\nconst $ = cheerio.load(items[1].data);\nconst englishURL = $('link[hreflang=\"en\"]').attr('href');\n\nreturn { \n  oldURL: items[0].json,\n  newURL: englishURL\n};"
      },
      "name": "Function2",
      "type": "n8n-nodes-base.function",
      "position": [
        208,
        400
      ],
      "id": "e0568dcb-a8d2-4f68-aa41-4a6b1b9184e1",
      "typeVersion": 1
    },
    {
      "parameters": {
        "options": {}
      },
      "name": "Set1",
      "type": "n8n-nodes-base.set",
      "position": [
        400,
        0
      ],
      "id": "1a59949b-0a50-4310-a2a8-6afeff6f712c",
      "typeVersion": 3.4
    },
    {
      "parameters": {
        "options": {}
      },
      "name": "Set2",
      "type": "n8n-nodes-base.set",
      "position": [
        400,
        400
      ],
      "id": "b0cc51f5-1bb9-404c-87a9-92c4d4d0e4e1",
      "typeVersion": 3.4
    }
  ],
  "origin": "n8n",
  "pinData": {},
  "repo": {
    "owner": "kamiyechung",
    "name": "Sauvegarde-n8n"
  },
  "settings": {
    "executionOrder": "v1"
  },
  "shared": [
    {
      "createdAt": "2025-10-24T13:50:42.470Z",
      "updatedAt": "2025-10-24T13:50:42.470Z",
      "role": "workflow:owner",
      "workflowId": "eoVJcPkrA6ozcqUk",
      "projectId": "oALk376RbKlV8lOt"
    }
  ],
  "staticData": null,
  "tags": [],
  "triggerCount": 0,
  "updatedAt": "2025-10-27T10:35:28.574Z",
  "versionId": "50d9f934-a923-4299-a2f6-e28f00bec425"
}